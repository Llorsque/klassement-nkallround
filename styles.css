/* ── Design Tokens ────────────────────────────────────── */
:root {
  --font-body: "DM Sans", system-ui, sans-serif;
  --font-mono: "IBM Plex Mono", "Menlo", monospace;
  --bg: #0c0e14;
  --surface-1: #141620;
  --surface-2: #1a1d2e;
  --surface-3: #222640;
  --border: rgba(255,255,255,.06);
  --border-hover: rgba(255,255,255,.12);
  --text: #e8eaf0;
  --text-dim: #7a809a;
  --text-muted: #4a4f68;
  --accent: #60a5fa;
  --accent-dim: rgba(96,165,250,.12);
  --gold: #fbbf24;
  --silver: #94a3b8;
  --bronze: #d97706;
  --green: #34d399;
  --red: #f87171;
  --orange: #F6AD55;
  --radius: 10px;
  --radius-sm: 6px;
  --sidebar-w: 200px;
  --topbar-h: 52px;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 14px; }
body { font-family: var(--font-body); background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }

/* ── Background orbs ─────────────────────────────────── */
.bg-orbs { position: fixed; inset: 0; pointer-events: none; z-index: 0; overflow: hidden; }
.bg-orb { position: absolute; border-radius: 50%; filter: blur(100px); opacity: .15; }
.bg-orb--1 { width: 600px; height: 600px; top: -200px; left: -100px; background: #3b82f6; }
.bg-orb--2 { width: 500px; height: 500px; bottom: -150px; right: -100px; background: #8b5cf6; }
.bg-orb--3 { width: 400px; height: 400px; top: 40%; left: 50%; background: #06b6d4; opacity: .08; }

/* ── Topbar ──────────────────────────────────────────── */
.topbar {
  position: fixed; top: 0; left: 0; right: 0; height: var(--topbar-h); z-index: 100;
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px;
  background: rgba(12,14,20,.85); backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border);
}
.topbar__brand { display: flex; align-items: center; gap: 10px; }
.topbar__logo { font-size: 20px; }
.topbar__title { font-size: 16px; font-weight: 800; letter-spacing: -.02em; }
.topbar__year { font-size: 11px; font-weight: 700; color: var(--accent); background: var(--accent-dim); padding: 2px 8px; border-radius: 999px; }
.topbar__controls { display: flex; align-items: center; gap: 8px; }

/* ── Status badge ────────────────────────────────────── */
.status-badge {
  display: inline-flex; align-items: center; gap: 6px;
  font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .04em;
  padding: 3px 10px; border-radius: 999px;
}
.status-badge--live { background: rgba(52,211,153,.12); color: var(--green); }
.status-badge--waiting { background: rgba(246,173,85,.12); color: var(--orange); }
.status-badge--manual { background: rgba(246,173,85,.12); color: var(--orange); }
.status-badge__pulse {
  width: 6px; height: 6px; border-radius: 50%; background: currentColor;
}
.status-badge--live .status-badge__pulse { animation: pulse 2s ease-in-out infinite; }
@keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: .3; } }

/* ── Layout ──────────────────────────────────────────── */
.layout {
  display: grid; grid-template-columns: var(--sidebar-w) 1fr;
  min-height: 100vh; padding-top: var(--topbar-h);
  position: relative; z-index: 1;
}

/* ── Sidebar ─────────────────────────────────────────── */
.sidebar {
  position: sticky; top: var(--topbar-h); height: calc(100vh - var(--topbar-h));
  display: flex; flex-direction: column; gap: 2px;
  padding: 12px; overflow-y: auto;
  background: rgba(20,22,32,.6); border-right: 1px solid var(--border);
}
.sidebar__section { margin-bottom: 8px; }
.sidebar__section--bottom { margin-top: auto; display: flex; flex-direction: column; gap: 6px; }
.sidebar__label {
  font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: .08em;
  color: var(--text-muted); padding: 4px 8px 2px; margin-bottom: 2px;
}

/* ── Tabs ─────────────────────────────────────────────── */
.tab-group--vertical { display: flex; flex-direction: column; gap: 2px; }
.tab {
  display: flex; align-items: center; gap: 8px;
  padding: 7px 10px; border: none; border-radius: var(--radius-sm);
  background: transparent; color: var(--text-dim); cursor: pointer;
  font-family: var(--font-body); font-size: 13px; font-weight: 500;
  transition: all .15s;
}
.tab:hover { background: var(--surface-2); color: var(--text); }
.tab.active { background: var(--accent-dim); color: var(--accent); font-weight: 700; }

/* ── Buttons ─────────────────────────────────────────── */
.btn { border: none; border-radius: var(--radius-sm); cursor: pointer; font-family: var(--font-body); transition: all .15s; }
.btn--ghost { background: transparent; color: var(--text-dim); padding: 6px 8px; font-size: 16px; }
.btn--ghost:hover { color: var(--text); background: var(--surface-2); }
.btn--outline { background: transparent; border: 1px solid var(--border); color: var(--text-dim); padding: 6px 12px; font-size: 12px; font-weight: 600; }
.btn--outline:hover { border-color: var(--border-hover); color: var(--text); }
.btn--sm { font-size: 11px; padding: 5px 10px; }
.btn--danger { background: rgba(248,113,113,.1); color: var(--red); border: 1px solid rgba(248,113,113,.2); padding: 5px 12px; font-size: 12px; font-weight: 600; }
.btn--danger:hover { background: rgba(248,113,113,.2); }
.cta {
  padding: 8px 14px; border: none; border-radius: var(--radius-sm);
  font-family: var(--font-body); font-size: 13px; font-weight: 700; cursor: pointer;
  transition: all .15s;
}
.cta--entry { background: linear-gradient(135deg, #F6AD55, #ED8936); color: #000; }
.cta--entry:hover { filter: brightness(1.1); }
.cta--primary { background: var(--accent); color: #000; }

/* ── Stage (main content) ────────────────────────────── */
.stage { padding: 20px 28px 40px; min-width: 0; }
.stage__header { margin-bottom: 16px; }
.stage__title { font-size: 22px; font-weight: 800; letter-spacing: -.02em; }
.stage__meta { font-size: 12px; color: var(--text-dim); margin-top: 2px; }

/* ── Tables ──────────────────────────────────────────── */
.table-wrap { overflow-x: auto; border-radius: var(--radius); border: 1px solid var(--border); background: var(--surface-1); }
.table { width: 100%; border-collapse: collapse; font-size: 13px; }
.table th {
  font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em;
  color: var(--text-muted); padding: 8px 12px; text-align: left;
  border-bottom: 1px solid var(--border); background: var(--surface-2);
  position: sticky; top: 0; z-index: 2;
}
.table td { padding: 7px 12px; border-bottom: 1px solid var(--border); vertical-align: middle; }
.table tbody tr:last-child td { border-bottom: none; }
.table tbody tr:hover { background: rgba(255,255,255,.02); }
.mono { font-family: var(--font-mono); font-size: 12px; font-weight: 500; }
.mono--bold { font-weight: 700; }

/* ── Podium rows ─────────────────────────────────────── */
.row--gold td:first-child { box-shadow: inset 3px 0 0 var(--gold); }
.row--silver td:first-child { box-shadow: inset 3px 0 0 var(--silver); }
.row--bronze td:first-child { box-shadow: inset 3px 0 0 var(--bronze); }

/* ── Rank & medals ───────────────────────────────────── */
.rank { display: inline-flex; align-items: center; justify-content: center; min-width: 26px; height: 22px; font-size: 12px; font-weight: 700; font-family: var(--font-mono); }
.rank--1 { color: var(--gold); }
.rank--2 { color: var(--silver); }
.rank--3 { color: var(--bronze); }
.dist-rank { font-size: 10px; color: var(--text-muted); margin-left: 6px; vertical-align: middle; }
.dist-rank--1 { color: var(--gold); }
.dist-rank--2 { color: var(--silver); }
.dist-rank--3 { color: var(--bronze); }

/* ── Delta & PB ──────────────────────────────────────── */
.delta { font-family: var(--font-mono); font-size: 11px; color: var(--text-dim); }
.delta--leader { color: var(--green); font-weight: 700; }
.pb-badge {
  display: inline-block; font-size: 9px; font-weight: 800; color: var(--red);
  background: rgba(248,113,113,.12); padding: 1px 5px; border-radius: 3px;
  margin-left: 6px; vertical-align: middle; letter-spacing: .03em;
}

/* ── Athlete name (clickable) ────────────────────────── */
.athlete-name { cursor: pointer; transition: color .15s; }
.athlete-name:hover { color: var(--accent); }

/* ── Info box ────────────────────────────────────────── */
.info-box {
  margin-top: 16px; padding: 12px 16px; border-radius: var(--radius);
  font-size: 12px; line-height: 1.6; color: var(--text-dim);
  background: var(--surface-1); border: 1px solid var(--border);
}

/* ── Inline controls ─────────────────────────────────── */
.inline-controls { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
.inline-controls__label { font-size: 12px; color: var(--text-dim); }
.select-wrap select {
  appearance: none; background: var(--surface-2); border: 1px solid var(--border);
  color: var(--text); padding: 4px 24px 4px 10px; border-radius: var(--radius-sm);
  font-family: var(--font-body); font-size: 12px; cursor: pointer;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%237a809a'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 8px center;
}

/* ── Distance split (distance view + sidebar) ────────── */
.dist-split { display: grid; grid-template-columns: 1fr 320px; gap: 20px; align-items: start; }
.dist-split__sidebar { position: sticky; top: calc(var(--topbar-h) + 16px); }

/* ── Compact klassement sidebar ──────────────────────── */
.klass-sidebar {
  background: var(--surface-1); border: 1px solid var(--border); border-radius: var(--radius);
}
.klass-sidebar__header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 12px 2px;
}
.klass-sidebar__title { font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: .06em; }
.klass-sidebar__status {
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  color: var(--accent); background: var(--accent-dim); padding: 2px 8px; border-radius: 999px;
}
.klass-sidebar__sub { font-size: 11px; color: var(--text-dim); padding: 0 12px 6px; }
.table--compact { font-size: 12px; }
.table--compact th { font-size: 9px; padding: 5px 8px; }
.table--compact td { padding: 4px 8px; }

/* ── Pair numbers (startlist) ────────────────────────── */
.pair-nr {
  display: inline-flex; align-items: center; justify-content: center;
  min-width: 24px; height: 22px; border-radius: var(--radius-sm);
  font-size: 11px; font-weight: 700; font-family: var(--font-mono);
  background: var(--surface-2); color: var(--text-dim); border: 1px solid var(--border);
}
.row--pending td { opacity: .55; }
.row--pending:hover td { opacity: .8; }
.table-sep td { padding: 6px 12px; border-bottom: none; }
.table-sep__label {
  display: inline-block; font-size: 10px; font-weight: 800; text-transform: uppercase;
  letter-spacing: .08em; color: var(--text-dim);
  padding: 3px 10px; background: var(--surface-2); border-radius: 999px; border: 1px solid var(--border);
}

/* ── H2H bar ─────────────────────────────────────────── */
.h2h-bar {
  display: flex; align-items: center; justify-content: center; gap: 10px;
  padding: 10px 20px; margin: -8px 0 12px;
}
.h2h-bar__vs { font-size: 11px; font-weight: 800; color: var(--text-muted); }
.h2h-bar select {
  appearance: none; background: var(--surface-2); border: 1px solid var(--border);
  color: var(--text); padding: 6px 28px 6px 12px; border-radius: var(--radius-sm);
  font-family: var(--font-body); font-size: 13px; cursor: pointer; min-width: 180px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%237a809a'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: right 10px center;
}

/* ── H2H mirror ──────────────────────────────────────── */
.mirror { border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; background: var(--surface-1); }
.mirror-header { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; padding: 12px 16px; background: var(--surface-2); }
.mirror-header__rider { font-size: 14px; font-weight: 700; }
.mirror-header__rider--right { text-align: right; }
.mirror-header__rank { font-size: 11px; color: var(--text-dim); margin-top: 2px; }
.mirror-header__vs { font-size: 11px; font-weight: 800; color: var(--text-muted); padding: 0 12px; }
.mirror-row { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; padding: 8px 16px; border-top: 1px solid var(--border); }
.mirror-row--total { background: var(--surface-2); }
.mirror-cell { font-family: var(--font-mono); font-size: 13px; font-weight: 500; }
.mirror-cell--right { text-align: right; }
.mirror-cell--win { color: var(--green); font-weight: 700; }
.mirror-cell--lose { color: var(--text-dim); }
.mirror-cell--total { font-weight: 700; }
.mirror-center { text-align: center; padding: 0 8px; }
.mirror-center__dist { font-size: 11px; font-weight: 700; color: var(--text-dim); text-transform: uppercase; }
.mirror-center__diff { display: block; font-size: 10px; font-family: var(--font-mono); margin-top: 2px; }
.mirror-center__diff--neg { color: var(--green); }
.mirror-center__diff--pos { color: var(--red); }

/* ── KPI cards ───────────────────────────────────────── */
.kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-bottom: 16px; }
.kpi-card {
  background: var(--surface-1); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 12px 14px;
}
.kpi-card__label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em; color: var(--text-muted); margin-bottom: 4px; }
.kpi-card__value { font-size: 20px; font-weight: 800; font-family: var(--font-mono); }
.kpi-card__sub { font-size: 11px; color: var(--text-dim); margin-top: 2px; }

/* ── Source tags ──────────────────────────────────────── */
.source-tag {
  display: inline-block; font-size: 10px; font-weight: 700; color: var(--accent);
  background: var(--accent-dim); padding: 1px 6px; border-radius: 3px;
}

/* ── Chip filters ────────────────────────────────────── */
.chip-group { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px; }
.chip {
  padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border);
  background: transparent; color: var(--text-dim); font-family: var(--font-body);
  font-size: 11px; font-weight: 600; cursor: pointer; transition: all .15s;
}
.chip:hover { border-color: var(--border-hover); color: var(--text); }
.chip.active { background: var(--accent-dim); border-color: var(--accent); color: var(--accent); }

/* ── Section labels ──────────────────────────────────── */
.section-label {
  font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: .06em;
  color: var(--text-muted); margin: 16px 0 8px; padding-bottom: 4px;
  border-bottom: 1px solid var(--border);
}

/* ── Popups & Modals ─────────────────────────────────── */
.popup-overlay {
  position: fixed; inset: 0; z-index: 200;
  display: flex; align-items: center; justify-content: center;
  background: rgba(0,0,0,.6); backdrop-filter: blur(4px);
}
.popup {
  background: var(--surface-1); border: 1px solid var(--border); border-radius: 14px;
  max-width: 560px; width: 92vw; max-height: 85vh; overflow-y: auto;
}
.popup--entry { max-width: 600px; }
.popup--debug { max-width: 740px; }
.popup__content { padding: 20px; }
.popup__close {
  position: absolute; top: 12px; right: 12px; background: none; border: none;
  color: var(--text-dim); font-size: 20px; cursor: pointer; padding: 4px;
}
.popup-section-label {
  font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: .06em;
  color: var(--text-muted); margin: 12px 0 6px;
}

/* ── Entry modal specifics ───────────────────────────── */
.entry-tabs { display: flex; gap: 4px; margin-bottom: 10px; flex-wrap: wrap; }
.entry-tab {
  padding: 5px 10px; border-radius: var(--radius-sm); border: 1px solid var(--border);
  background: transparent; color: var(--text-dim); font-family: var(--font-body);
  font-size: 11px; font-weight: 600; cursor: pointer; position: relative;
}
.entry-tab.active { background: var(--accent-dim); border-color: var(--accent); color: var(--accent); }
.entry-tab__dot {
  position: absolute; top: -2px; right: -2px; width: 6px; height: 6px;
  border-radius: 50%; background: var(--green); display: none;
}
.entry-tab.has-data .entry-tab__dot { display: block; }
.entry-modes { display: flex; gap: 6px; margin-bottom: 10px; }
.entry-mode {
  padding: 4px 10px; border: 1px solid var(--border); border-radius: var(--radius-sm);
  background: transparent; color: var(--text-dim); font-family: var(--font-body);
  font-size: 11px; cursor: pointer;
}
.entry-mode.active { background: var(--surface-3); color: var(--text); }
.entry-fields { display: flex; flex-direction: column; gap: 4px; max-height: 360px; overflow-y: auto; }
.entry-row { display: grid; grid-template-columns: 50px 1fr 110px; gap: 8px; align-items: center; font-size: 12px; }
.entry-row__pair { font-family: var(--font-mono); font-size: 11px; color: var(--text-dim); }
.entry-row__input {
  background: var(--surface-2); border: 1px solid var(--border); border-radius: var(--radius-sm);
  color: var(--text); font-family: var(--font-mono); font-size: 12px; font-weight: 500;
  padding: 5px 8px; text-align: center; width: 100%;
}
.entry-row__input:focus { outline: none; border-color: var(--accent); }
.entry-paste__area {
  width: 100%; min-height: 200px; resize: vertical;
  background: var(--surface-2); border: 1px solid var(--border); border-radius: var(--radius-sm);
  color: var(--text); font-family: var(--font-mono); font-size: 12px; padding: 10px;
}
.entry-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 12px; padding-top: 10px; border-top: 1px solid var(--border); }

/* ── Qualification view ──────────────────────────────── */
.qual-section { margin-bottom: 20px; }
.qual-badge {
  display: inline-block; font-size: 10px; font-weight: 700; padding: 2px 8px;
  border-radius: 999px; margin-left: 6px;
}
.qual-badge--both { background: rgba(52,211,153,.12); color: var(--green); }
.qual-badge--dist { background: rgba(246,173,85,.12); color: var(--orange); }
.qual-badge--klass { background: rgba(248,113,113,.12); color: var(--red); }
.qual-badge--out { background: rgba(122,128,154,.12); color: var(--text-dim); }

/* ── Grouped table ───────────────────────────────────── */
.table--grouped .table-group-sep td { padding: 4px 12px; border-bottom: none; }

/* ── Toast ───────────────────────────────────────────── */
.toast {
  position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
  background: var(--surface-3); color: var(--text); border: 1px solid var(--border);
  padding: 8px 20px; border-radius: 999px; font-size: 12px; font-weight: 600;
  z-index: 300; box-shadow: 0 8px 32px rgba(0,0,0,.4);
}

/* ── Responsive ──────────────────────────────────────── */
@media (max-width: 1024px) {
  .dist-split { grid-template-columns: 1fr 260px; }
}
@media (max-width: 768px) {
  :root { --sidebar-w: 0px; }
  .sidebar { display: none; }
  .dist-split { grid-template-columns: 1fr; }
  .dist-split__sidebar { position: static; }
  .stage { padding: 14px 12px 30px; }
}

/* ── Scrollbar ───────────────────────────────────────── */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--surface-3); border-radius: 3px; }
